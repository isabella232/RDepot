<databaseChangeLog 
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog" 
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" 
    xmlns:pro="http://www.liquibase.org/xml/ns/pro" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext 
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd 
    http://www.liquibase.org/xml/ns/pro 
    http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.0.xsd 
    http://www.liquibase.org/xml/ns/dbchangelog 
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.0.xsd
    ">         
    
    <changeSet  id="01_01_package_maintainer_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="package_maintainer" schemaName="public"/>            	
            </not>  
        </preConditions>  
        <createTable  tableName="package_maintainer" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="user_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="package"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="repository_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="deleted"  type="boolean" defaultValue="false">
            	<constraints nullable="false"/>
            </column>  
        </createTable>  
        <rollback/>
    </changeSet>  
    
    <changeSet  id="01_02_package_table"  author="pgleska">  
    	<preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="package" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="package" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="name"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="version"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="description"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="author"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="maintainer_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="repository_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="depends"  type="text">
            	<constraints nullable="true"/>
            </column>
            <column  name="imports"  type="text">
            	<constraints nullable="true"/>
            </column>
            <column  name="suggests"  type="text">
            	<constraints nullable="true"/>
            </column>
            <column  name="system_requirements"  type="text">
            	<constraints nullable="true"/>
            </column>
            <column  name="license"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="url"  type="text">
            	<constraints nullable="true"/>
            </column>
            <column  name="source"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="title"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="active"  type="boolean" defaultValue="false">
            	<constraints nullable="false"/>
            </column>
            <column  name="deleted"  type="boolean" defaultValue="false">
            	<constraints nullable="false"/>
            </column>                        
            <column  name="md5sum"  type="text">
            	<constraints nullable="true"/>
            </column> 
        </createTable>  
        <rollback/>
    </changeSet>  
    
    <changeSet  id="01_03_repository_maintainer_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="repository_maintainer" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="repository_maintainer" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="user_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="repository_id"  type="integer">
            	<constraints nullable="false"/>
            </column>  
            <column  name="deleted"  type="boolean" defaultValue="false">
            	<constraints nullable="false"/>
            </column>
        </createTable>  
        <rollback/>
    </changeSet>
    
    <changeSet  id="01_04_repository_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="repository" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="repository" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="version"  type="integer" defaultValue="0">
            	<constraints nullable="false"/>
            </column>
            <column  name="publication_uri"  type="text">
            	<constraints unique="true" nullable="false"/>
            </column>  
            <column  name="name"  type="text">
            	<constraints unique="true" nullable="false"/>
            </column>
            <column  name="server_address"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="published"  type="boolean" defaultValue="false">
            	<constraints nullable="false"/>
            </column>
            <column  name="deleted"  type="boolean" defaultValue="false">
            	<constraints nullable="false"/>
            </column>
        </createTable>  
        <rollback/>
    </changeSet>
    
    <changeSet  id="01_05_role_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="role" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="role" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="value"  type="integer">
            	<constraints unique="true" nullable="false"/>
            </column>
            <column  name="name"  type="text">
            	<constraints unique="true" nullable="false"/>
            </column>
            <column  name="description"  type="text">
            	<constraints unique="true" nullable="false"/>
            </column>  
        </createTable>  
        <rollback/>
        <insert schemaName="public"  
	            tableName="role">  
	        <column name="id"  value="1"/>
	        <column name="value"  value="0"/>
	        <column name="name"  value="user"/>
	        <column name="description"  value="User"/>
	    </insert>
	    <insert schemaName="public"  
	            tableName="role">  
	        <column name="id"  value="2"/>
	        <column name="value"  value="1"/>
	        <column name="name"  value="packagemaintainer"/>
	        <column name="description"  value="Package Maintainer"/>  
	    </insert>
	    <insert schemaName="public"  
	            tableName="role">  
	        <column name="id"  value="3"/>
	        <column name="value"  value="2"/>
	        <column name="name"  value="repositorymaintainer"/>
	        <column name="description"  value="Repository Maintainer"/>
	    </insert>
	    <insert schemaName="public"  
	            tableName="role">  
	        <column name="id"  value="4"/>
	        <column name="value"  value="3"/>
	        <column name="name"  value="admin"/>
	        <column name="description"  value="Administrator"/>  
	    </insert>
	    <sql dbms="postgresql">select setval('role_id_seq', max(id)+1) from role</sql>
    </changeSet>
    
    <changeSet  id="01_06_submmision_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="submission" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="submission" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="submitter_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="package_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="accepted"  type="boolean" defaultValue="false">
 	          	<constraints nullable="false"/>
            </column>
            <column  name="deleted"  type="boolean" defaultValue="false">
            	<constraints nullable="false"/>
            </column>
            <column  name="changes"  type="text">
            	<constraints nullable="true"/>
            </column>   
        </createTable>  
        <rollback/>
    </changeSet>
    
    <changeSet  id="01_07_user_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="user" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="user" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="role_id"  type="integer" defaultValue="4">
            	<constraints nullable="false"/>
            </column>
            <column  name="name"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="email"  type="text">
            	<constraints unique="true" nullable="false"/>
            </column>
            <column  name="login"  type="text">
            	<constraints unique="true" nullable="false"/>
            </column>
            <column  name="active"  type="boolean">
            	<constraints nullable="false"/>
            </column>
            <column  name="last_logged_in_on"  type="date">
 	          	<constraints nullable="true"/>
            </column>
            <column  name="deleted"  type="boolean" defaultValue="false">
            	<constraints nullable="false"/>
            </column>  
        </createTable>  
        <rollback/>
        <insert schemaName="public"  
	            tableName="user">  
	        <column name="id"  value="4"/>
	        <column name="role_id"  value="4"/>
	        <column name="name"  value="Albert Einstein"/>
	        <column name="email"  value="einstein@ldap.forumsys.com"/>
	        <column name="login"  value="einstein"/>
	        <column name="active"  value="true"/>
	        <column name="last_logged_in_on"  value="null"/>
	        <column name="deleted"  value="false"/>  
	    </insert>
	    <insert schemaName="public"  
	            tableName="user">  
	        <column name="id"  value="5"/>
	        <column name="role_id"  value="3"/>
	        <column name="name"  value="Nikola Tesla"/>
	        <column name="email"  value="tesla@ldap.forumsys.com"/>
	        <column name="login"  value="tesla"/>
	        <column name="active"  value="true"/>
	        <column name="last_logged_in_on"  value="null"/>
	        <column name="deleted"  value="false"/>  
	    </insert>  
	    <insert schemaName="public"  
	            tableName="user">  
	        <column name="id"  value="6"/>
	        <column name="role_id"  value="2"/>
	        <column name="name"  value="Galileo Galilei"/>
	        <column name="email"  value="galieleo@ldap.forumsys.com"/>
	        <column name="login"  value="galieleo"/>
	        <column name="active"  value="true"/>
	        <column name="last_logged_in_on"  value="null"/>
	        <column name="deleted"  value="false"/>  
	    </insert>
	    <insert schemaName="public"  
	            tableName="user">  
	        <column name="id"  value="7"/>
	        <column name="role_id"  value="1"/>
	        <column name="name"  value="Isaac Newton"/>
	        <column name="email"  value="newton@ldap.forumsys.com"/>
	        <column name="login"  value="newton"/>
	        <column name="active"  value="true"/>
	        <column name="last_logged_in_on"  value="null"/>
	        <column name="deleted"  value="false"/>  
	    </insert>
	    <insert schemaName="public"  
	            tableName="user">  
	        <column name="id"  value="8"/>
	        <column name="role_id"  value="4"/>
	        <column name="name"  value="Local Admin User"/>
	        <column name="email"  value="admin@localhost"/>
	        <column name="login"  value="admin"/>
	        <column name="active"  value="true"/>
	        <column name="last_logged_in_on"  value="null"/>
	        <column name="deleted"  value="false"/>  
	    </insert>
	    <sql dbms="postgresql">select setval('user_id_seq', max(id)+1) from "user"</sql>
    </changeSet>
    
    <changeSet  id="01_08_event_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="event" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="event" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="value"  type="character varying(255)">
            	<constraints unique="true" nullable="false"/>
            </column>            
        </createTable>  
        <rollback/>
        <insert schemaName="public"  
	            tableName="event">  
	        <column name="id" value="1"/>
	        <column name="value" value="create"/>  
	    </insert>
	    <insert schemaName="public"  
	            tableName="event">  
	        <column name="id" value="2"/>
	        <column name="value" value="delete"/>  
	    </insert>
	    <insert schemaName="public"  
	            tableName="event">  
	        <column name="id"  value="3"/>
	        <column name="value"  value="update"/>  
	    </insert>
    </changeSet>
    
    <changeSet  id="01_09_package_event_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="package_event" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="package_event" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="date"  type="date" defaultValueDate="now()">
            	<constraints nullable="false"/>
            </column>
            <column  name="package_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="event_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_variable"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_before"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_after"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_by"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="time"  type="time with time zone" defaultValueDate="now()">
            	<constraints nullable="true"/>
            </column>            
        </createTable>  
        <rollback/>
    </changeSet>
    
    <changeSet  id="01_10_package_maintainer_event_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="package_maintainer_event" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="package_maintainer_event" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="date"  type="date" defaultValueDate="now()">
            	<constraints nullable="false"/>
            </column>
            <column  name="package_maintainer_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="event_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_variable"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_before"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_after"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_by"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="time"  type="time with time zone" defaultValueDate="now()">
            	<constraints nullable="true"/>
            </column>            
        </createTable>  
        <rollback/>
    </changeSet>
    
    <changeSet  id="01_11_repository_event_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="repository_event" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="repository_event" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="date"  type="date" defaultValueDate="now()">
            	<constraints nullable="false"/>
            </column>
            <column  name="repository_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="event_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_variable"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_before"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_after"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_by"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="time"  type="time with time zone" defaultValueDate="now()">
            	<constraints nullable="true"/>
            </column>            
        </createTable>  
        <rollback/>
    </changeSet>
    
    <changeSet  id="01_12_repository_maintainer_event_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="repository_maintainer_event" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="repository_maintainer_event" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="date"  type="date" defaultValueDate="now()">
            	<constraints nullable="false"/>
            </column>
            <column  name="repository_maintainer_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="event_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_variable"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_before"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_after"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_by"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="time"  type="time with time zone" defaultValueDate="now()">
            	<constraints nullable="true"/>
            </column>            
        </createTable>  
        <rollback/>
    </changeSet>
    
    <changeSet  id="01_13_submission_event_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="submission_event" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="submission_event" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="date"  type="date" defaultValueDate="now()">
            	<constraints nullable="false"/>
            </column>
            <column  name="submission_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="event_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_variable"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_before"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_after"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_by"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="time"  type="time with time zone" defaultValueDate="now()">
            	<constraints nullable="true"/>
            </column>            
        </createTable>  
        <rollback/>
    </changeSet>  
    
    <changeSet  id="01_14_user_event_table"  author="pgleska">  
        <preConditions  onFail="MARK_RAN">  
            <not>
            	<tableExists tableName="user_event" schemaName="public"/>
            </not>  
        </preConditions>  
        <createTable  tableName="user_event" schemaName="public">  
            <column  name="id"  type="integer" autoIncrement="true" startWith="1" incrementBy="1">
            	<constraints primaryKey="true"/>
            </column>  
            <column  name="date"  type="date" defaultValueDate="now()">
            	<constraints nullable="false"/>
            </column>
            <column  name="user_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="event_id"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_variable"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_before"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="value_after"  type="text">
            	<constraints nullable="false"/>
            </column>
            <column  name="changed_by"  type="integer">
            	<constraints nullable="false"/>
            </column>
            <column  name="time"  type="time with time zone" defaultValueDate="now()">
            	<constraints nullable="true"/>
            </column>            
        </createTable>  
        <rollback/>
        <insert schemaName="public"  
	            tableName="user_event">  
	        <column name="id"  value="1"/>
	        <column name="date"  value="now()"/>
	        <column name="user_id"  value="4"/>
	        <column name="event_id"  value="1"/>
	        <column name="changed_variable"  value="created"/>
	        <column name="value_before"  value=""/>
	        <column name="value_after"  value=""/>
	        <column name="changed_by"  value="4"/>
	        <column name="time"  value="now()"/>  
	    </insert>
	    <insert schemaName="public"  
	            tableName="user_event">  
	        <column name="id"  value="2"/>
	        <column name="date"  value="now()"/>
	        <column name="user_id"  value="5"/>
	        <column name="event_id"  value="1"/>
	        <column name="changed_variable"  value="created"/>
	        <column name="value_before"  value=""/>
	        <column name="value_after"  value=""/>
	        <column name="changed_by"  value="5"/>
	        <column name="time"  value="now()"/>  
	    </insert>
		<insert schemaName="public"  
	            tableName="user_event">  
	        <column name="id"  value="3"/>
	        <column name="date"  value="now()"/>
	        <column name="user_id"  value="6"/>
	        <column name="event_id"  value="1"/>
	        <column name="changed_variable"  value="created"/>
	        <column name="value_before"  value=""/>
	        <column name="value_after"  value=""/>
	        <column name="changed_by"  value="6"/>
	        <column name="time"  value="now()"/>  
	    </insert>
	    <insert schemaName="public"  
	            tableName="user_event">  
	        <column name="id"  value="4"/>
	        <column name="date"  value="now()"/>
	        <column name="user_id"  value="7"/>
	        <column name="event_id"  value="1"/>
	        <column name="changed_variable"  value="created"/>
	        <column name="value_before"  value=""/>
	        <column name="value_after"  value=""/>
	        <column name="changed_by"  value="7"/>
	        <column name="time"  value="now()"/>  
	    </insert>
		<insert schemaName="public"  
	            tableName="user_event">  
	        <column name="id"  value="5"/>
	        <column name="date"  value="now()"/>
	        <column name="user_id"  value="8"/>
	        <column name="event_id"  value="1"/>
	        <column name="changed_variable"  value="created"/>
	        <column name="value_before"  value=""/>
	        <column name="value_after"  value=""/>
	        <column name="changed_by"  value="8"/>
	        <column name="time"  value="now()"/>  
	    </insert>
	    <sql dbms="postgresql">select setval('user_event_id_seq', max(id)+1) from user_event</sql>
    </changeSet>
    
    <changeSet id="01_15_addForeignKeyConstraint_by_user_package_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="by_user" schemaName="public" foreignKeyTableName="package_event"/>
    		</not>
    	</preConditions>
    	<addForeignKeyConstraint
    		constraintName="by_user"
    		baseColumnNames="changed_by"              
            baseTableName="package_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>            
    </changeSet>
    
    <changeSet id="01_16_addForeignKeyConstraint_by_user_package_maintainer_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="by_user" schemaName="public" foreignKeyTableName="package_maintainer_event"/>
    		</not>
    	</preConditions>
		<addForeignKeyConstraint
    		constraintName="by_user"
    		baseColumnNames="changed_by"              
            baseTableName="package_maintainer_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                        
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
    </changeSet>
                
    <changeSet id="01_17_addForeignKeyConstraint_by_user_repository_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="by_user" schemaName="public" foreignKeyTableName="repository_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="by_user"
    		baseColumnNames="changed_by"              
            baseTableName="repository_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
	</changeSet>
    
    <changeSet id="01_18_addForeignKeyConstraint_by_user_repository_maintainer_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="by_user" schemaName="public" foreignKeyTableName="repository_maintainer_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="by_user"
    		baseColumnNames="changed_by"              
            baseTableName="repository_maintainer_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
	</changeSet>
    
    <changeSet id="01_19_addForeignKeyConstraint_by_user_submission_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="by_user" schemaName="public" foreignKeyTableName="submission_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="by_user"
    		baseColumnNames="changed_by"              
            baseTableName="submission_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
	</changeSet>
    
    <changeSet id="01_20_addForeignKeyConstraint_by_user_user_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="by_user" schemaName="public" foreignKeyTableName="user_event"/>
    		</not>
    	</preConditions>            
        <addForeignKeyConstraint
    		constraintName="by_user"
    		baseColumnNames="changed_by"              
            baseTableName="user_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_21_addForeignKeyConstraint_doing_event_package_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="doing_event" schemaName="public" foreignKeyTableName="package_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="doing_event"
    		baseColumnNames="event_id"              
            baseTableName="package_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="event"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_22_addForeignKeyConstraint_doing_event_package_maintainer_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="doing_event" schemaName="public" foreignKeyTableName="package_maintainer_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="doing_event"
    		baseColumnNames="event_id"              
            baseTableName="package_maintainer_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="event"  
            referencedTableSchemaName="public"/>
     </changeSet>
    
    <changeSet id="01_23_addForeignKeyConstraint_doing_event_repository_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="doing_event" schemaName="public" foreignKeyTableName="repository_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="doing_event"
    		baseColumnNames="event_id"              
            baseTableName="repository_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="event"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_24_addForeignKeyConstraint_doing_event_repository_maintainer_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="doing_event" schemaName="public" foreignKeyTableName="repository_maintainer_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="doing_event"
    		baseColumnNames="event_id"              
            baseTableName="repository_maintainer_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="event"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_25_addForeignKeyConstraint_doing_event_submission_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="doing_event" schemaName="public" foreignKeyTableName="submission_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="doing_event"
    		baseColumnNames="event_id"              
            baseTableName="submission_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="event"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_26_addForeignKeyConstraint_doing_event_user_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="doing_event" schemaName="public" foreignKeyTableName="user_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="doing_event"
    		baseColumnNames="event_id"              
            baseTableName="user_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="event"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_27_addForeignKeyConstraint_for_package_submission" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="for_package" schemaName="public" foreignKeyTableName="submission"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="for_package"
    		baseColumnNames="package_id"              
            baseTableName="submission"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="package"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_28_addForeignKeyConstraint_for_repository_package" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="for_repository" schemaName="public" foreignKeyTableName="package"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="for_repository"
    		baseColumnNames="repository_id"              
            baseTableName="package"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="repository"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_29_addForeignKeyConstraint_from_user_submission" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="from_user" schemaName="public" foreignKeyTableName="submission"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="from_user"
    		baseColumnNames="submitter_id"              
            baseTableName="submission"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_30_addForeignKeyConstraint_has_role_user" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="has_role" schemaName="public" foreignKeyTableName="user"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="has_role"
    		baseColumnNames="role_id"              
            baseTableName="user"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="role"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_31_addForeignKeyConstraint_is_maintainer_of_package" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="is_maintainer_of" schemaName="public" foreignKeyTableName="package"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="is_maintainer_of"
    		baseColumnNames="maintainer_id"              
            baseTableName="package"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_32_addForeignKeyConstraint_is_package_maintainer_package_maintainer" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="is_package_maintainer" schemaName="public" foreignKeyTableName="package_maintainer"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="is_package_maintainer"
    		baseColumnNames="user_id"              
            baseTableName="package_maintainer"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
    </changeSet>
     
    <changeSet id="01_33_addForeignKeyConstraint_is_package_maintainer_of_package_maintainer" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="is_package_maintainer_of" schemaName="public" foreignKeyTableName="package_maintainer"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="is_package_maintainer_of"
    		baseColumnNames="repository_id"              
            baseTableName="package_maintainer"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="repository"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_34_addForeignKeyConstraint_is_repository_maintainer_repository_maintainer" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="is_repository_maintainer" schemaName="public" foreignKeyTableName="repository_maintainer"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="is_repository_maintainer"
    		baseColumnNames="user_id"              
            baseTableName="repository_maintainer"  
            baseTableSchemaName="public"      
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"                                  
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
   	</changeSet>
    
    <changeSet id="01_35_addForeignKeyConstraint_of_package_package_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="of_package" schemaName="public" foreignKeyTableName="package_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="of_package"
    		baseColumnNames="package_id"              
            baseTableName="package_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"
            referencedColumnNames="id"    
            referencedTableName="package"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_36_addForeignKeyConstraint_of_package_maintainer_package_maintainer_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="of_package_maintainer" schemaName="public" foreignKeyTableName="package_maintainer_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="of_package_maintainer"
    		baseColumnNames="package_maintainer_id"              
            baseTableName="package_maintainer_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"
            referencedColumnNames="id"    
            referencedTableName="package_maintainer"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_37_addForeignKeyConstraint_of_repository_repository_maintainer" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="of_repository" schemaName="public" foreignKeyTableName="repository_maintainer"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="of_repository"
    		baseColumnNames="repository_id"              
            baseTableName="repository_maintainer"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"
            referencedColumnNames="id"    
            referencedTableName="repository"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_38_addForeignKeyConstraint_of_repository_repository_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="of_repository" schemaName="public" foreignKeyTableName="repository_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="of_repository"
    		baseColumnNames="repository_id"              
            baseTableName="repository_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"
            referencedColumnNames="id"    
            referencedTableName="repository"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_39_addForeignKeyConstraint_of_repository_maintainer_repository_maintainer_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="of_repository_maintainer" schemaName="public" foreignKeyTableName="repository_maintainer_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="of_repository_maintainer"
    		baseColumnNames="repository_maintainer_id"              
            baseTableName="repository_maintainer_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"
            referencedColumnNames="id"    
            referencedTableName="repository_maintainer"
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_40_addForeignKeyConstraint_of_submission_submission_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="of_submission" schemaName="public" foreignKeyTableName="submission_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="of_submission"
    		baseColumnNames="submission_id"              
            baseTableName="submission_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"
            referencedColumnNames="id"    
            referencedTableName="submission"  
            referencedTableSchemaName="public"/>
    </changeSet>
    
    <changeSet id="01_41_addForeignKeyConstraint_of_user_user_event" author="pgleska">
    	<preConditions onFail="MARK_RAN">
    		<not>
    			<foreignKeyConstraintExists foreignKeyName="of_user" schemaName="public" foreignKeyTableName="user_event"/>
    		</not>
    	</preConditions>
        <addForeignKeyConstraint
    		constraintName="of_user"
    		baseColumnNames="user_id"              
            baseTableName="user_event"  
            baseTableSchemaName="public"
            onDelete="NO ACTION"  
            onUpdate="NO ACTION"
            referencedColumnNames="id"    
            referencedTableName="user"  
            referencedTableSchemaName="public"/>
	</changeSet>	
</databaseChangeLog>
